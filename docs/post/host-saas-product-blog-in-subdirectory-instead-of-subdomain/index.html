<!DOCTYPE html>
<html>
<head>
  <title>Host Saas Product Blog in Subdirectory Instead of Subdomain</title>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="apple-touch-icon" sizes="57x57" href="/img/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/img/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/img/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/img/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/img/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/img/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/img/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/img/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/img/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="msapplication-TileColor" content="#243342">
  <meta name="msapplication-TileImage" content="/img/ms-icon-144x144.png">
  <meta name="theme-color" content="#243342">

  <link rel="canonical" href="https://www.codiva.io/blog/post/host-saas-product-blog-in-subdirectory-instead-of-subdomain/">

  <style rel="stylesheet" type="text/css">
    @import 'https://fonts.googleapis.com/css?family=Roboto:300,400,500';

    * {
      margin: 0;
      padding: 0;
      -moz-box-sizing: border-box;
      -webkit-box-sizing: border-box;
      box-sizing: border-box;
    }
    *, *:before, *:after {
      box-sizing: inherit;
    }
    body {
      font-family: "Roboto", "Helvetica", "Arial", "Verdana", sans-serif;
    }
    blockquote {
        background-color: lightgray;
        padding: 0.25em 0.5em;
        margin: 1em;
        font-size: 1.2em;
    }
    .mainContainer {
      clear: both;
    }
    .mainContainer:after {
      clear: both;
    }
    .mainContainer ol, .mainContainer ul {
      padding: 0 0 0 40px;
    }
    .mainContainer p {
      margin: 1em 0;
    }
    .header a {
      text-decoration: none;
      padding: 1.5em 1em;
    }
    .header a:link, .header a:visited {
      color: white;
      display: inline-block;
    }

    .header {
      padding: 0 10px;
      height: 4em;
      xbackground-color: #06065C;
      background-color: #243342;
      text-color: white;
    }
    .header ul {
      margin: 0px;
      padding: 0px;
    }
    .logo {
      display: inline;
      float: left;
      font-family: "Heiti SC", "Verdana", sans-serif;
    }
    .header .logo a {
      color: #4cae51;
    }
    .top-nav {
      display: inline;
      float: left;
    }
    .top-nav ul {
      list-style: none;
    }
    .top-nav li {
      display: inline;
    }
    .header .login-signup, .header .new-project {
      display: "inline";
      float: right;
    }
    .header .login-signup li,  .header .new-project li, .header .new-project li form {
      display: inline;
    }
    .header .new-project li a, .header .new-project li button {
      margin-top: 0.75em;
    }
    .humanText {
      max-width: 22em;
      margin: auto;
    }
    .header .button {
      padding: 0.75em 1em;
    }
    .bg-orange {
      background-color: #E56723;
      color: white;
    }
    .bg-green {
      background-color: #4CAF50;  

    }
    #logoutForm {
      display: inline
    }
    #logoutLink {
       display: inline;
    }
    .linkButton {
       display: inline;
       background: none;
       border: none;
       cursor: pointer;
       color: white;
    }

    .button {
      border: none;
      color: white;
      padding: 15px 32px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      margin: 4px 2px;
      cursor: pointer;
      border-radius: 8px;
    }

    .modalDialog {
      z-index: 99999;
      opacity:0;
      -webkit-transition: opacity 400ms ease-in;
      -moz-transition: opacity 400ms ease-in;
      transition: opacity 400ms ease-in;
      pointer-events: none;
    }
     
    .pagination, .tags {
      height: 3em;
    }
    .pagination li, 
    .tags li {
      display: inline;
      min-height: 3em;
    }
    .pagination li a, 
    .tags li a {
      display: inline-block;
      padding: 1em;
    }
    .tags {
      list-style: none;
    }
    .main {
      max-width: 50em;
      margin: 0 auto; 
      line-height: 1.5;
      padding: 1em 1em;
      color: #555;

    }
    .main h2, .main h1 {
      margin-top: 0.5em;
      padding: 0.5em 0;
    }
    .main h1,
    .main h2,
    .main strong {
      color: #333;
    }
    .main code,
    .main pre {
      background: #eee;
    }

    .main code {
      padding: 2px 4px;
      vertical-align: text-bottom;
    }

    .main pre {
      padding: 1em;
    }

    .main a {
      color: #4cae51;
    }

   @media all and (max-width: 650px) {
    .header {
      padding: 0px;
    }
    .top-nav {
      display: none;
    }
    .screenshot, .explain {
        float: none;
        width: 95%;
        height: auto;
        padding-top:1em;
        margin: auto;
    }

    .screenshot img {
      max-width: 100%;
      margin: auto;
      display: block;
    }
   }
   @media all and (max-width: 340px) {
     .logo {
       display: none;
     }
   }        
   </style>
</head>
<body>

  <header class="header">
    <span class="logo">
      <a href="/">Codiva.io</a>
    </span>
      
    <nav class="top-nav">
      <ul>
        <li><a href="/blog">Blog</a></li>
        <li><a href="/profile">My Projects</a></li>
        <li><a href="/tutorials">Tutorials</a></li>
      </ul>
    </nav>

  </header>

  <div class="mainContainer">
    
  <div class="main">
    <h2>Host Saas Product Blog in Subdirectory Instead of Subdomain</h2>
    <p>You have a SAAS product. Now you want to add articles, blogs, tutorials, etc to support your product or for content marketing and SEO. Should you have these hosted as a subdomain (<a href="https://blog.example.com">https://blog.example.com</a>) or as a subdirectory (<a href="https://example.com/blog)?">https://example.com/blog)?</a>
</p>

<p>Google&rsquo;s official guideline is a bit vague (Do the right thing for your user and your long term plan.), but many SEO experts believe, subdirectory (/blog) is the right choice.</p>

<p>As a developer, I would prefer to have a subdomain. Because, I could simply add a <em>A record</em> or <em>CNAME entry</em> in the DNS and point to my blog host (Wordpress or GitHub pages).
It is simple and fast with negligible overhead. A DNS lookup for the first request, then everything is cached.</p>

<p>However, hosting as a subdirectory is a bit slow. You will have to configure on your webserver. If you use NGINX, it will be something like,</p>

<pre><code>location /blog {
  proxy_pass etc..
}
</code></pre>

<p>Then, for each request, the request will first reach your server that will then be sent to the blog host. The response from the blog host will then get proxied back to the user.</p>

<p>This is unnecessarily slow. Codiva blog is hosted in GitHub pages, that is globally distributed superfast server. But the rest of my site is locaated only in the US. Global replication is expensive. With the subdirectory, approach, users&rsquo; request anywhere in the world will reach the US servers, then get proxied to somewhere near my server.</p>

<p>As a developer sensitive to latency issues, I hate this.</p>

<p>But not any more. Enter <em>Cloudflare Service Worker</em>.</p>

<h3 id="cloudflare-service-workers-config">Cloudflare Service Workers config</h3>

<p>Codiva.io Blog is hosted in Github Pages with https. The github url looks something like <a href="https://username.github.io/codiva-blog">https://username.github.io/codiva-blog</a>. I want this to be served as <a href="https://www.codiva.io/blog">https://www.codiva.io/blog</a></p>

<p>In cloudflare worker, intercept the request. If the url path starts with /blog/, fetch the request from github instead.</p>

<pre><code>addEventListener('fetch', event =&gt; {
  var url = new URL(event.request.url);
  if (url.pathname.startsWith('/blog/') || url.pathname === '/blog') {
    handleBlog(event, url);
  } else {
    event.respondWith(fetch(event.request));
  }
})

async function handleBlog(event, url) {
  var originUrl = url.toString().replace(
    'https://www.codiva.io/blog',
   'https://example.github.io/codiva-blog');
  event.respondWith(fetch(originUrl)); 
}

</code></pre>

<p>This is very similar to the proxy_pass solution. Except, this runs in Cloudflare CDN close to the user and much more widely distributed than most blog hosting platforms.</p>

<p>This solution is much faster than proxy_pass on your webserver.</p>

    
<ul id="tags" class="tags">
  
  	
  
  
</ul>

  </div>

    
  </div>
</body>
</html>
